<!DOCTYPE html><html><head><title>Call Tracking</title><style>body, html {
  height:100%;
  width:100%;
  padding:0;
  margin:0;
  overflow:hidden;
  background-color:#ddd;
}
.wrapper {
  height:100%;
  width:100%;
}</style><link rel="shortcut icon" href="//twilio.com/bundles/marketing/img/favicons/favicon.ico"><link rel="apple-touch-icon" href="//twilio.com/bundles/marketing/img/favicons/favicon_57.png"><link rel="apple-touch-icon" sizes="72x72" href="//twilio.com/bundles/marketing/img/favicons/favicon_72.png"><link rel="apple-touch-icon" sizes="114x114" href="//twilio.com/bundles/marketing/img/favicons/favicon_114.png"><link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css"><link rel="stylesheet" href="viewsaurus.css"></head><body><div class="wrapper"><div id="viewsaurus" data-title="Call Tracking"><div class="saurus-panes"><div class="saurus-prose"><div class="saurus-prose-header"><div class="title-outer"><span class="step-title">Call Tracking</span></div></div><div class="saurus-nav-buttons"><div class="saurus-nav-button nav-overview"><div class="saurus-nav-button-inner"><i class="fa fa-fw fa-list"></i></div><div class="nav-divider"></div></div><div class="saurus-nav-button nav-previous"><div class="saurus-nav-button-inner"><a href=""> <i class="fa fa-fw fa-play fa-rotate-180"></i></a></div><div class="nav-divider"></div></div><div class="saurus-nav-button nav-next clickable"><div class="saurus-nav-button-inner"><a href="#1"> <i class="fa fa-fw fa-play"></i></a></div></div><div class="saurus-next-title"><span class="next-title-inner"></span></div></div><div class="saurus-progress-bar"></div><div class="saurus-start"><p>Use Twilio to track the effectiveness of your marketing campaigns. Let's get started!</p><a href="#0">Start Tutorial</a></div><div class="saurus-content"><div data-title="Call Tracking with Twilio, Node.js and Express " class="chapter"><div data-file="webapp.js" class="step"><h2 id="what-does-this-thing-do-">What does this thing do?</h2>
<p>This <a href="http://expressjs.com/">Express.js</a> web application shows
how you can use Twilio to track the effectiveness of different
marketing channels.</p>
<p>This application has three main features:</p>
<ul>
<li>It purchases phone numbers from Twilio to use in different marketing
campaigns (like a billboard or a bus advertisement)</li>
<li>It forwards incoming calls for those phone numbers to a salesperson</li>
<li>It displays charts showing data about the phone numbers and the calls
they receive</li>
</ul>
<p>The application uses MongoDB together with Mongoose as the persistence layer.</p>
<p>In this tutorial, we&#39;ll point out the key bits of code that make
this application work.  <a href="https://github.com/twiliodeved/call-tracking-node">Check out the project README on
GitHub</a> to
see how to run the code yourself.</p>
<p>Let&#39;s get started! Click the right arrow above to advance to the next
code snippet.</p>
<hr>
<p><strong>See also:</strong></p>
<ul>
<li><a href="http://twilio.github.io/twilio-node/">Twilio Node Helper Library</a></li>
<li><a href="https://www.twilio.com/docs/api">Twilio REST API docs</a></li>
<li><a href="http://expressjs.com/starter/installing.html">Getting started with Express.js</a></li>
<li><a href="http://docs.mongodb.org/manual/">Getting started with MongoDB</a></li>
<li><a href="http://mongoosejs.com/docs/index.html">Mongoose quickstart</a></li>
<li><a href="http://www.searchenginejournal.com/seo-beginner-guide-call-tracking-care/83173/">What is Call Tracking?</a></li>
</ul>
</div><div data-file="controllers/availableNumbers.js" class="step"><h2 id="search-for-available-phone-numbers">Search for available phone numbers</h2>
<p>Call tracking requires us to search for and buy phone numbers on
demand, associating a specific phone number with a lead
source. We make a server-side request (possibly with a filter
area code) asking Twilio for available phone numbers.</p>
<hr>
<p><strong>See also:</strong></p>
<ul>
<li><a href="http://twilio.github.io/twilio-node/">Twilio Node Helper Library</a></li>
<li><a href="http://twilio.github.io/twilio-node/#callbacks">Callbacks versus Promises</a></li>
<li><a href="http://twilio.github.io/twilio-node/#moreexamples">Twilio Node examples</a></li>
<li><a href="https://www.twilio.com/docs/api/rest/available-phone-numbers">REST API: Available Phone Numbers</a></li>
</ul>
</div><div data-file="views/availableNumbers.jade" class="step"><h2 id="display-available-phone-numbers">Display available phone numbers</h2>
<p>We display a form to the user on the app&#39;s home page which
allows them to search for a new phone number by area code. We
make a request (possibly with a filter area code) through the
application&#39;s backend asking Twilio for available phone
numbers. We also define a form that can be used to buy a
specific number</p>
<hr>
<p><strong>See also:</strong></p>
<ul>
<li><a href="http://jade-lang.com/">Jade template engine</a></li>
<li><a href="http://jade-lang.com/reference/">Jade language reference</a></li>
<li><a href="http://expressjs.com/guide/using-template-engines.html">Usings template engines with Express</a></li>
</ul>
</div><div data-file="controllers/leadSources.js" data-highlight="5-27" class="step"><h2 id="buy-a-phone-number">Buy a phone number</h2>
<p>The <code>create</code> function for the LeadSource resource expects a phone
number as a parameter and purchases a number through Twilio&#39;s
API on behalf of this application&#39;s user. It enables the caller
ID feature and associates the number to the current TwiML app
SID. It immediately redirects the user so she can add a
forwarding number and a description for the lead source.</p>
<p>Next, we&#39;ll how this is done.</p>
<hr>
<p><strong>See also:</strong></p>
<ul>
<li><a href="https://www.twilio.com/docs/api/rest/available-phone-numbers">Twilio REST API: Available Phone Numbers</a></li>
<li><a href="http://twilio.github.io/twilio-node/#moreexamples">Twilio Node examples</a></li>
<li><a href="http://mongoosejs.com/docs/api.html#model_Model-save">Save models with Mongoose</a></li>
</ul>
</div><div data-file="controllers/leadSources.js" data-highlight="49-74" class="step"><h2 id="associate-a-phone-number-with-a-lead-source">Associate a phone number with a lead source</h2>
<p>Once we have bought a number we display a form so the user can
add a forwarding number and a description for this number. From
now on, any call to this number will be attributed to this
source. All phone numbers should be in E.164 format.</p>
<hr>
<p><strong>See also:</strong></p>
<ul>
<li><a href="http://mongoosejs.com/docs/queries.html">Mongoose queries</a></li>
<li><a href="https://github.com/jadejs/jade/blob/master/examples/form.jade">Forms with Jade</a></li>
<li><a href="http://expressjs.com/api.html">Express.js API documentation</a></li>
<li><a href="https://en.wikipedia.org/wiki/E.164">E.164 format</a></li>
</ul>
</div><div data-file="models/LeadSource.js" class="step"><h2 id="the-leadsource-model">The LeadSource model</h2>
<p>This is the model that contains the information provided in the
form from the previous step. The <code>LeadSource</code> model associates a
Twilio number to a named lead source (like &quot;Wall Street Journal
Ad&quot; or &quot;Dancing guy with sign&quot;). It also tracks a phone number
to which we&#39;d like all the calls redirected, like your sales or</p>
<h2 id="support-help-line-">support help line.</h2>
<p><strong>See also:</strong></p>
<ul>
<li><a href="http://mongoosejs.com/docs/models.html">Mongoose models</a></li>
<li><a href="http://mongoosejs.com/docs/populate.html">Mongoose populate</a></li>
<li><a href="http://mongoosejs.com/docs/schematypes.html">Mongoose schema types</a></li>
</ul>
</div><div data-file="models/Lead.js" class="step"><h2 id="the-lead-model">The Lead model</h2>
<p>A <code>Lead</code> represents a phone call generated by a
<code>LeadSource</code>. Each time somebody calls a phone number associated
with a <code>LeadSource</code>, we&#39;ll use the <code>Lead</code> model to record some
of the <a href="https://www.twilio.com/docs/api/twiml/twilio_request">data Twilio gives
us</a> about
their call.</p>
<hr>
<p><strong>See also:</strong></p>
<ul>
<li><a href="http://mongoosejs.com/docs/models.html">Mongoose models</a></li>
<li><a href="http://mongoosejs.com/docs/populate.html">Mongoose populate</a></li>
<li><a href="http://mongoosejs.com/docs/schematypes.html">Mongoose schema types</a></li>
</ul>
</div><div data-file="controllers/leads.js" data-highlight="8-30" class="step"><h2 id="forward-calls-and-create-leads">Forward calls and create leads</h2>
<p>Whenever a customer calls one of our Twilio numbers, Twilio will
send a POST request to the URL associated with this view
function (should be <code>/lead</code>).</p>
<p>We use the incoming call data to create a new <code>Lead</code> for a
<code>LeadSource</code>, then return
<a href="https://www.twilio.com/docs/api/twiml">TwiML</a> that connects our
caller with the <code>forwarding_number</code> of our <code>LeadSource</code>.</p>
<hr>
<p><strong>See also:</strong></p>
<ul>
<li><a href="https://www.twilio.com/docs/api/twiml/twilio_request">Twilio voice request parameters</a></li>
<li><a href="http://twilio.github.io/twilio-node/#twimlBasic">TwiML basics with twilio-node</a></li>
<li><a href="https://www.twilio.com/docs/api/twiml/dial">TwiML &lt;Dial&gt; verb</a></li>
</ul>
</div><div data-file="controllers/leads.js" data-highlight="32-53" class="step"><h2 id="get-statistics-about-our-lead-sources">Get statistics about our lead sources</h2>
<p>One useful statistic we can get from our data is how many calls
each <code>LeadSource</code> has received. We might also want to know the
cities the leads are coming from. For this we define two</p>
<h2 id="eloquent-queries-">Eloquent queries.</h2>
<p><strong>See also:</strong></p>
<ul>
<li><a href="http://mongoosejs.com/docs/populate.html">Mongoose population</a></li>
<li><a href="http://underscorejs.org/">Underscore.js</a></li>
<li><a href="http://underscorejs.org/#countBy">Underscore.js countBy</a></li>
</ul>
</div><div data-file="public/js/pieCharts.js" class="step"><h2 id="visualize-our-statistics-with-chart-js">Visualize our statistics with Chart.js</h2>
<p>Back on the home page, we fetch call tracking statistics <a href="http://laravel.com/docs/5.1/responses#json-responses">in
JSON from the
server</a>
using <a href="https://api.jquery.com/jquery.get/">jQuery</a>.  We display
the stats in colorful pie charts we create with
<a href="http://www.chartjs.org/">Chart.js</a>.</p>
</div><div data-file="index.js" class="step"><h2 id="where-to-next-">Where to next?</h2>
<p>That&#39;s it! Our Laravel application is now ready to purchase new phone
numbers, forward incoming calls, and record some statistics for our
business. </p>
<p>If you&#39;re a PHP developer working with Twilio, you might also enjoy these
tutorials:</p>
<p><a href="https://www.twilio.com/docs/howto/walkthrough/click-to-call/php/laravel"><strong>Click-To-Call (Laravel)</strong></a></p>
<p>Put a button on your web page that connects visitors to live support or sales people via telephone.</p>
<p><a href="https://www.twilio.com/docs/howto/walkthrough/appointment-reminders/php/laravel"><strong>Appointment Reminders (Laravel)</strong></a></p>
<p>Send your customers automatic reminders ahead of appoiments using Twilio
SMS.</p>
<p>Thanks for checking out this tutorial! If you have any feedback to share
with us, we&#39;d love to hear it. Tweet <a href="https://twitter.com/twilio">@twilio</a>
to let us know what you think.</p>
</div></div>
<div class="saurus-files" style="display:none;"><textarea class="saurus-file" data-file="webapp.js" data-mode="javascript">dmFyIHBhdGggPSByZXF1aXJlKCdwYXRoJyk7CnZhciBleHByZXNzID0gcmVxdWlyZSgnZXhwcmVzcycpOwp2YXIgYm9keVBhcnNlciA9IHJlcXVpcmUoJ2JvZHktcGFyc2VyJyk7CnZhciBleHByZXNzVmFsaWRhdG9yID0gcmVxdWlyZSgnZXhwcmVzcy12YWxpZGF0b3InKTsKdmFyIHNlc3Npb24gPSByZXF1aXJlKCdleHByZXNzLXNlc3Npb24nKTsKdmFyIGZsYXNoID0gcmVxdWlyZSgnY29ubmVjdC1mbGFzaCcpOwp2YXIgbW9yZ2FuID0gcmVxdWlyZSgnbW9yZ2FuJyk7CnZhciBjc3VyZiA9IHJlcXVpcmUoJ2NzdXJmJyk7CnZhciBjb25maWcgPSByZXF1aXJlKCcuL2NvbmZpZycpOwoKLy8gQ3JlYXRlIEV4cHJlc3Mgd2ViIGFwcAp2YXIgYXBwID0gZXhwcmVzcygpOwphcHAuc2V0KCd2aWV3IGVuZ2luZScsICdqYWRlJyk7CgovLyBVc2UgbW9yZ2FuIGZvciBIVFRQIHJlcXVlc3QgbG9nZ2luZyBpbiBkZXYgYW5kIHByb2QKaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAndGVzdCcpIHsKICBhcHAudXNlKG1vcmdhbignY29tYmluZWQnKSk7Cn0KCi8vIFNlcnZlIHN0YXRpYyBhc3NldHMKYXBwLnVzZShleHByZXNzLnN0YXRpYyhwYXRoLmpvaW4oX19kaXJuYW1lLCAncHVibGljJykpKTsKCi8vIFBhcnNlIGluY29taW5nIGZvcm0tZW5jb2RlZCBIVFRQIGJvZGllcwphcHAudXNlKGJvZHlQYXJzZXIudXJsZW5jb2RlZCh7CiAgZXh0ZW5kZWQ6IHRydWUKfSkpOwoKLy8gVmFsaWRhdGUgcmVxdWVzdHMKYXBwLnVzZShleHByZXNzVmFsaWRhdG9yKCkpOwoKLy8gQ3JlYXRlIGFuZCBtYW5hZ2UgSFRUUCBzZXNzaW9ucyBmb3IgYWxsIHJlcXVlc3RzCmFwcC51c2Uoc2Vzc2lvbih7CiAgc2VjcmV0OiBjb25maWcuc2VjcmV0LAogIHJlc2F2ZTogdHJ1ZSwKICBzYXZlVW5pbml0aWFsaXplZDogdHJ1ZQp9KSk7CgovLyBVc2UgY29ubmVjdC1mbGFzaCB0byBwZXJzaXN0IGluZm9ybWF0aW9uYWwgbWVzc2FnZXMgYWNyb3NzIHJlZGlyZWN0cwphcHAudXNlKGZsYXNoKCkpOwoKLy8gQ29uZmlndXJlIGFwcGxpY2F0aW9uIHJvdXRlcwp2YXIgcm91dGVzID0gcmVxdWlyZSgnLi9jb250cm9sbGVycy9yb3V0ZXInKTsKdmFyIHdlYlJvdXRlciA9IGV4cHJlc3MuUm91dGVyKCk7CnZhciB3ZWJob29rUm91dGVyID0gZXhwcmVzcy5Sb3V0ZXIoKTsKCi8vIEFkZCB0aGUgQ1NSRiBwcm90ZWN0aW9uIGZvciB3ZWIgcm91dGVzCmlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Rlc3QnKSB7CiAgd2ViUm91dGVyLnVzZShjc3VyZigpKTsKICB3ZWJSb3V0ZXIudXNlKGZ1bmN0aW9uKHJlcXVlc3QsIHJlc3BvbnNlLCBuZXh0KSB7CiAgICByZXNwb25zZS5sb2NhbHMuY3NyZnRva2VuID0gcmVxdWVzdC5jc3JmVG9rZW4oKTsKICAgIG5leHQoKTsKICB9KTsKfQoKcm91dGVzLndlYmhvb2tSb3V0ZXMod2ViaG9va1JvdXRlcik7CnJvdXRlcy53ZWJSb3V0ZXMod2ViUm91dGVyKTsKCmFwcC51c2Uod2ViaG9va1JvdXRlcik7CmFwcC51c2Uod2ViUm91dGVyKTsKCi8vIEhhbmRsZSA0MDQKYXBwLnVzZShmdW5jdGlvbihyZXF1ZXN0LCByZXNwb25zZSwgbmV4dCkgewogIHJlc3BvbnNlLnN0YXR1cyg0MDQpOwogIHJlc3BvbnNlLnNlbmRGaWxlKHBhdGguam9pbihfX2Rpcm5hbWUsICdwdWJsaWMnLCAnNDA0Lmh0bWwnKSk7Cn0pOwoKLy8gVW5oYW5kbGVkIGVycm9ycyAoNTAwKQphcHAudXNlKGZ1bmN0aW9uKGVyciwgcmVxdWVzdCwgcmVzcG9uc2UsIG5leHQpIHsKICBjb25zb2xlLmVycm9yKCdBbiBhcHBsaWNhdGlvbiBlcnJvciBoYXMgb2NjdXJyZWQ6Jyk7CiAgY29uc29sZS5lcnJvcihlcnIpOwogIGNvbnNvbGUuZXJyb3IoZXJyLnN0YWNrKTsKICByZXNwb25zZS5zdGF0dXMoNTAwKTsKICByZXNwb25zZS5zZW5kRmlsZShwYXRoLmpvaW4oX19kaXJuYW1lLCAncHVibGljJywgJzUwMC5odG1sJykpOwp9KTsKCi8vIEV4cG9ydCBFeHByZXNzIGFwcAptb2R1bGUuZXhwb3J0cyA9IGFwcDsK</textarea>
<textarea class="saurus-file" data-file="controllers/availableNumbers.js" data-mode="javascript">dmFyIHR3aWxpbyA9IHJlcXVpcmUoJ3R3aWxpbycpOwp2YXIgY29uZmlnID0gcmVxdWlyZSgnLi4vY29uZmlnJyk7Cgp2YXIgaW5kZXhBdmFpbGFibGVOdW1iZXJzID0gZnVuY3Rpb24ocmVxdWVzdCwgcmVzcG9uc2UpIHsKICB2YXIgY2xpZW50ID0gdHdpbGlvKGNvbmZpZy5hY2NvdW50U2lkLCBjb25maWcuYXV0aFRva2VuKTsKCiAgdmFyIGFyZWFDb2RlID0gcmVxdWVzdC5xdWVyeS5hcmVhQ29kZTsKCiAgY2xpZW50LmF2YWlsYWJsZVBob25lTnVtYmVycygnVVMnKS5sb2NhbC5saXN0KHsnYXJlYUNvZGUnOiBhcmVhQ29kZX0pCiAgICAgICAgLnRoZW4oZnVuY3Rpb24oYXZhaWxhYmxlTnVtYmVycykgewogICAgICAgICAgcmVzcG9uc2UucmVuZGVyKAogICAgICAgICAgICAgICdhdmFpbGFibGVOdW1iZXJzJywKICAgICAgICAgICAgICB7J2F2YWlsYWJsZU51bWJlcnMnOiBhdmFpbGFibGVOdW1iZXJzLmF2YWlsYWJsZVBob25lTnVtYmVyc30KICAgICAgICAgICk7CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZmFpbHVyZVRvRmV0Y2hOdW1iZXJzKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygnRmFpbGVkIHRvIGZldGNoIG51bWJlcnMgZnJvbSBBUEknKTsKICAgICAgICAgIGNvbnNvbGUubG9nKCdFcnJvciB3YXM6Jyk7CiAgICAgICAgICBjb25zb2xlLmxvZyhmYWlsdXJlVG9GZXRjaE51bWJlcnMpOwogICAgICAgICAgcmVzcG9uc2Uuc3RhdHVzKDUwMCkuc2VuZCgnQ291bGQgbm90IGNvbnRhY3QgVHdpbGlvIEFQSScpOwogICAgICAgIH0pOwp9OwoKZXhwb3J0cy5pbmRleCA9IGluZGV4QXZhaWxhYmxlTnVtYmVyczsK</textarea>
<textarea class="saurus-file" data-file="views/availableNumbers.jade" data-mode="jade">ZXh0ZW5kcyBsYXlvdXQKCmJsb2NrIGNvbnRlbnQKICBkaXYucm93CiAgICBkaXYuY29sLWxnLTQKICAgICAgdGFibGUudGFibGUKICAgICAgICB0aGVhZAogICAgICAgICAgdHIKICAgICAgICAgICAgdGggUGhvbmUgbnVtYmVyCiAgICAgICAgICAgIHRoIFN0YXRlCiAgICAgICAgICAgIHRoCiAgICAgICAgdGJvZHkKICAgICAgICAgIGVhY2ggbnVtYmVyIGluIGF2YWlsYWJsZU51bWJlcnMKICAgICAgICAgICAgdHIKICAgICAgICAgICAgICB0ZD0gbnVtYmVyLmZyaWVuZGx5TmFtZQogICAgICAgICAgICAgIHRkPSBudW1iZXIucmVnaW9uCiAgICAgICAgICAgICAgdGQKICAgICAgICAgICAgICAgIGZvcm0obmFtZT0ncHVyY2hhc2VOdW1iZXInLCBhY3Rpb249Jy9sZWFkLXNvdXJjZScsIG1ldGhvZD0nUE9TVCcpCiAgICAgICAgICAgICAgICAgIGlucHV0KHR5cGU9J2hpZGRlbicsIG5hbWU9J3Bob25lTnVtYmVyJywgdmFsdWU9IiN7bnVtYmVyLnBob25lX251bWJlcn0iKQogICAgICAgICAgICAgICAgICBpbnB1dCh0eXBlPSdoaWRkZW4nLCBuYW1lPSdfY3NyZicsIHZhbHVlPSIje2NzcmZ0b2tlbn0iKQogICAgICAgICAgICAgICAgICBpbnB1dCh0eXBlPSdzdWJtaXQnLCB2YWx1ZT0nUHVyY2hhc2UnKS5idG4uYnRuLXNtLmJ0bi1wcmltYXJ5Cg==</textarea>
<textarea class="saurus-file" data-file="controllers/leadSources.js" data-mode="javascript">dmFyIHR3aWxpbyA9IHJlcXVpcmUoJ3R3aWxpbycpOwp2YXIgY29uZmlnID0gcmVxdWlyZSgnLi4vY29uZmlnJyk7CnZhciBMZWFkU291cmNlID0gcmVxdWlyZSgnLi4vbW9kZWxzL0xlYWRTb3VyY2UnKTsKCnZhciBjcmVhdGUgPSBmdW5jdGlvbihyZXF1ZXN0LCByZXNwb25zZSkgewogIHZhciBwaG9uZU51bWJlclRvUHVyY2hhc2UgPSByZXF1ZXN0LmJvZHkucGhvbmVOdW1iZXI7CiAgdmFyIGNsaWVudCA9IHR3aWxpbyhjb25maWcuYWNjb3VudFNpZCwgY29uZmlnLmF1dGhUb2tlbik7CgogIGNsaWVudC5pbmNvbWluZ1Bob25lTnVtYmVycy5jcmVhdGUoewogICAgcGhvbmVOdW1iZXI6IHBob25lTnVtYmVyVG9QdXJjaGFzZSwKICAgIHZvaWNlQ2FsbGVySWRMb29rdXA6IHRydWUsCiAgICB2b2ljZUFwcGxpY2F0aW9uU2lkOiBjb25maWcuYXBwU2lkCiAgfSkKICAgICAgICAudGhlbihmdW5jdGlvbihwdXJjaGFzZWROdW1iZXIpIHsKICAgICAgICAgIHZhciBsZWFkU291cmNlID0gbmV3IExlYWRTb3VyY2Uoe251bWJlcjogcHVyY2hhc2VkTnVtYmVyLnBob25lTnVtYmVyfSk7CiAgICAgICAgICByZXR1cm4gbGVhZFNvdXJjZS5zYXZlKCk7CiAgICAgICAgfSkKICAgICAgICAudGhlbihmdW5jdGlvbihzYXZlZExlYWRTb3VyY2UpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCdTYXZpbmcgbGVhZCBzb3VyY2UnKTsKICAgICAgICAgIHJlc3BvbnNlLnJlZGlyZWN0KDMwMywgJy9sZWFkLXNvdXJjZS8nICsgc2F2ZWRMZWFkU291cmNlLl9pZCArICcvZWRpdCcpOwogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKG51bWJlclB1cmNoYXNlRmFpbHVyZSkgewogICAgICAgICAgY29uc29sZS5sb2coJ0NvdWxkIG5vdCBwdXJjaGFzZSBhIG51bWJlciBmb3IgbGVhZCBzb3VyY2U6Jyk7CiAgICAgICAgICBjb25zb2xlLmxvZyhudW1iZXJQdXJjaGFzZUZhaWx1cmUpOwogICAgICAgICAgcmVzcG9uc2Uuc3RhdHVzKDUwMCkuc2VuZCgnQ291bGQgbm90IGNvbnRhY3QgVHdpbGlvIEFQSScpOwogICAgICAgIH0pOwp9OwoKdmFyIGVkaXQgPSBmdW5jdGlvbihyZXF1ZXN0LCByZXNwb25zZSkgewogIHZhciBsZWFkU291cmNlSWQgPSByZXF1ZXN0LnBhcmFtcy5pZDsKICBMZWFkU291cmNlLmZpbmRPbmUoe19pZDogbGVhZFNvdXJjZUlkfSkKICAgICAgICAudGhlbihmdW5jdGlvbihmb3VuZExlYWRTb3VyY2UpIHsKICAgICAgICAgIHJldHVybiByZXNwb25zZS5yZW5kZXIoCiAgICAgICAgICAgICAgJ2VkaXRMZWFkU291cmNlJywKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgbGVhZFNvdXJjZUlkOiBmb3VuZExlYWRTb3VyY2UuX2lkLAogICAgICAgICAgICAgICAgICBsZWFkU291cmNlUGhvbmVOdW1iZXI6IGZvdW5kTGVhZFNvdXJjZS5udW1iZXIsCiAgICAgICAgICAgICAgICAgIGxlYWRTb3VyY2VGb3J3YXJkaW5nTnVtYmVyOiBmb3VuZExlYWRTb3VyY2UuZm9yd2FyZGluZ051bWJlciwKICAgICAgICAgICAgICAgICAgbGVhZFNvdXJjZURlc2NyaXB0aW9uOiBmb3VuZExlYWRTb3VyY2UuZGVzY3JpcHRpb24sCiAgICAgICAgICAgICAgICAgIG1lc3NhZ2VzOiByZXF1ZXN0LmZsYXNoKCdlcnJvcicpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICk7CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goZnVuY3Rpb24oKSB7CiAgICAgICAgICByZXR1cm4gcmVzcG9uc2Uuc3RhdHVzKDQwNCkuc2VuZCgnTm8gc3VjaCBsZWFkIHNvdXJjZScpOwogICAgICAgIH0pOwp9OwoKdmFyIHVwZGF0ZSA9IGZ1bmN0aW9uKHJlcXVlc3QsIHJlc3BvbnNlKSB7CiAgdmFyIGxlYWRTb3VyY2VJZCA9IHJlcXVlc3QucGFyYW1zLmlkOwoKICByZXF1ZXN0LmNoZWNrQm9keSgnZGVzY3JpcHRpb24nLCAnRGVzY3JpcHRpb24gY2Fubm90IGJlIGVtcHR5Jykubm90RW1wdHkoKTsKICByZXF1ZXN0LmNoZWNrQm9keSgnZm9yd2FyZGluZ051bWJlcicsICdGb3J3YXJkaW5nIG51bWJlciBjYW5ub3QgYmUgZW1wdHknKS5ub3RFbXB0eSgpOwoKICBpZiAocmVxdWVzdC52YWxpZGF0aW9uRXJyb3JzKCkpIHsKICAgIHJlcXVlc3QuZmxhc2goJ2Vycm9yJywgcmVxdWVzdC52YWxpZGF0aW9uRXJyb3JzKCkpOwogICAgcmV0dXJuIHJlc3BvbnNlLnJlZGlyZWN0KDMwMywgJy9sZWFkLXNvdXJjZS8nICsgbGVhZFNvdXJjZUlkICsgJy9lZGl0Jyk7CiAgfQoKICBMZWFkU291cmNlLmZpbmRPbmUoe19pZDogbGVhZFNvdXJjZUlkfSkKICAgICAgICAudGhlbihmdW5jdGlvbihmb3VuZExlYWRTb3VyY2UpIHsKICAgICAgICAgIGZvdW5kTGVhZFNvdXJjZS5kZXNjcmlwdGlvbiA9IHJlcXVlc3QuYm9keS5kZXNjcmlwdGlvbjsKICAgICAgICAgIGZvdW5kTGVhZFNvdXJjZS5mb3J3YXJkaW5nTnVtYmVyID0gcmVxdWVzdC5ib2R5LmZvcndhcmRpbmdOdW1iZXI7CgogICAgICAgICAgcmV0dXJuIGZvdW5kTGVhZFNvdXJjZS5zYXZlKCk7CiAgICAgICAgfSkKICAgICAgICAudGhlbihmdW5jdGlvbihzYXZlZExlYWRTb3VyY2UpIHsKICAgICAgICAgIHJldHVybiByZXNwb25zZS5yZWRpcmVjdCgzMDMsICcvZGFzaGJvYXJkJyk7CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyb3IpIHsKICAgICAgICAgIHJldHVybiByZXNwb25zZS5zdGF0dXMoNTAwKS5zZW5kKCdDb3VsZCBub3Qgc2F2ZSB0aGUgbGVhZCBzb3VyY2UnKTsKICAgICAgICB9KTsKCn07CgpleHBvcnRzLmNyZWF0ZSA9IGNyZWF0ZTsKZXhwb3J0cy5lZGl0ID0gZWRpdDsKZXhwb3J0cy51cGRhdGUgPSB1cGRhdGU7Cg==</textarea>
<textarea class="saurus-file" data-file="models/LeadSource.js" data-mode="javascript">dmFyIG1vbmdvb3NlID0gcmVxdWlyZSgnbW9uZ29vc2UnKTsKCnZhciBMZWFkU291cmNlU2NoZW1hID0gbmV3IG1vbmdvb3NlLlNjaGVtYSh7CiAgbnVtYmVyOiB7dHlwZTogU3RyaW5nLCByZXF1aXJlZDogdHJ1ZX0sCiAgZGVzY3JpcHRpb246IHt0eXBlOiBTdHJpbmcsIHJlcXVpcmVkOiBmYWxzZX0sCiAgZm9yd2FyZGluZ051bWJlcjoge3R5cGU6IFN0cmluZywgcmVxdWlyZWQ6IGZhbHNlfQp9KTsKCi8vIENyZWF0ZSBhIE1vbmdvb3NlIG1vZGVsIGZyb20gb3VyIHNjaGVtYQp2YXIgTGVhZFNvdXJjZSA9IG1vbmdvb3NlLm1vZGVsKCdMZWFkU291cmNlJywgTGVhZFNvdXJjZVNjaGVtYSk7CgovLyBleHBvcnQgbW9kZWwgYXMgb3VyIG1vZHVsZSBpbnRlcmZhY2UKbW9kdWxlLmV4cG9ydHMgPSBMZWFkU291cmNlOwo=</textarea>
<textarea class="saurus-file" data-file="models/Lead.js" data-mode="javascript">dmFyIG1vbmdvb3NlID0gcmVxdWlyZSgnbW9uZ29vc2UnKTsKCnZhciBMZWFkU2NoZW1hID0gbmV3IG1vbmdvb3NlLlNjaGVtYSh7CiAgY2FsbGVyTnVtYmVyOiB7dHlwZTogU3RyaW5nLCByZXF1aXJlZDogdHJ1ZX0sCiAgY2FsbFNpZDoge3R5cGU6IFN0cmluZywgcmVxdWlyZWQ6IHRydWV9LAogIGxlYWRTb3VyY2U6IHt0eXBlOiBtb25nb29zZS5TY2hlbWEuVHlwZXMuT2JqZWN0SWQsIHJlZjogJ0xlYWRTb3VyY2UnfSwKICBjaXR5OiB7dHlwZTogU3RyaW5nLCByZXF1aXJlZDogZmFsc2V9LAogIHN0YXRlOiB7dHlwZTogU3RyaW5nLCByZXF1aXJlZDogZmFsc2V9LAogIGNhbGxlck5hbWU6IHt0eXBlOiBTdHJpbmcsIHJlcXVpcmVkOiBmYWxzZX0KfSk7CgovLyBDcmVhdGUgYSBNb25nb29zZSBtb2RlbCBmcm9tIG91ciBzY2hlbWEKdmFyIExlYWQgPSBtb25nb29zZS5tb2RlbCgnTGVhZCcsIExlYWRTY2hlbWEpOwoKLy8gZXhwb3J0IG1vZGVsIGFzIG91ciBtb2R1bGUgaW50ZXJmYWNlCm1vZHVsZS5leHBvcnRzID0gTGVhZDsK</textarea>
<textarea class="saurus-file" data-file="controllers/leads.js" data-mode="javascript">dmFyIExlYWRTb3VyY2UgPSByZXF1aXJlKCcuLi9tb2RlbHMvTGVhZFNvdXJjZScpOwp2YXIgTGVhZCA9IHJlcXVpcmUoJy4uL21vZGVscy9MZWFkJyk7CnZhciBjb25maWcgPSByZXF1aXJlKCcuLi9jb25maWcnKTsKCnZhciB0d2lsaW8gPSByZXF1aXJlKCd0d2lsaW8nKTsKdmFyIF8gPSByZXF1aXJlKCd1bmRlcnNjb3JlJyk7Cgp2YXIgY3JlYXRlID0gZnVuY3Rpb24ocmVxdWVzdCwgcmVzcG9uc2UpIHsKICB2YXIgbGVhZFNvdXJjZU51bWJlciA9IHJlcXVlc3QuYm9keS5UbzsKCiAgTGVhZFNvdXJjZS5maW5kT25lKHtudW1iZXI6IGxlYWRTb3VyY2VOdW1iZXJ9KQogICAgICAgIC50aGVuKGZ1bmN0aW9uKGZvdW5kTGVhZFNvdXJjZSkgewogICAgICAgICAgdmFyIHR3aW1sID0gbmV3IHR3aWxpby5Ud2ltbFJlc3BvbnNlKCk7CiAgICAgICAgICB0d2ltbC5kaWFsKGZvdW5kTGVhZFNvdXJjZS5mb3J3YXJkaW5nTnVtYmVyKTsKICAgICAgICAgIHJlc3BvbnNlLnNlbmQodHdpbWwudG9TdHJpbmcoKSk7CgogICAgICAgICAgdmFyIG5ld0xlYWQgPSBuZXcgTGVhZCh7Y2FsbGVyTnVtYmVyOiByZXF1ZXN0LmJvZHkuRnJvbSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsU2lkOiByZXF1ZXN0LmJvZHkuQ2FsbFNpZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWFkU291cmNlOiBmb3VuZExlYWRTb3VyY2UuX2lkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNpdHk6IHJlcXVlc3QuYm9keS5Gcm9tQ2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZTogcmVxdWVzdC5ib2R5LkZyb21TdGF0ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsZXJOYW1lOiByZXF1ZXN0LmJvZHkuQ2FsbGVyTmFtZX0pOwoKICAgICAgICAgIHJldHVybiBuZXdMZWFkLnNhdmUoKTsKICAgICAgICB9KQogICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCdGYWlsZWQgdG8gZm9yd2FyZCBjYWxsOicpOwogICAgICAgICAgY29uc29sZS5sb2coZXJyKTsKICAgICAgICB9KTsKfTsKCnZhciBsZWFkc0J5TGVhZFNvdXJjZSA9IGZ1bmN0aW9uKHJlcXVlc3QsIHJlc3BvbnNlKSB7CiAgTGVhZC5maW5kKHt9KQogICAgICAucG9wdWxhdGUoJ2xlYWRTb3VyY2UnKQogICAgICAgIC50aGVuKGZ1bmN0aW9uKGV4aXN0aW5nTGVhZHMpIHsKICAgICAgICAgIHZhciBzdGF0c0J5TGVhZFNvdXJjZSA9IF8uY291bnRCeShleGlzdGluZ0xlYWRzLCBmdW5jdGlvbihsZWFkKSB7CiAgICAgICAgICAgIHJldHVybiBsZWFkLmxlYWRTb3VyY2UuZGVzY3JpcHRpb247CiAgICAgICAgICB9KTsKCiAgICAgICAgICByZXNwb25zZS5zZXQoJ0NvbnRlbnQtVHlwZScsICdhcHBsaWNhdGlvbi9qc29uJyk7CiAgICAgICAgICByZXR1cm4gcmVzcG9uc2Uuc2VuZChzdGF0c0J5TGVhZFNvdXJjZSk7CiAgICAgICAgfSk7Cn07Cgp2YXIgbGVhZHNCeUNpdHkgPSBmdW5jdGlvbihyZXF1ZXN0LCByZXNwb25zZSkgewogIExlYWQuZmluZCh7fSkKICAgICAgICAudGhlbihmdW5jdGlvbihleGlzdGluZ0xlYWRzKSB7CiAgICAgICAgICB2YXIgc3RhdHNCeUNpdHkgPSBfLmNvdW50QnkoZXhpc3RpbmdMZWFkcywgJ2NpdHknKTsKCiAgICAgICAgICByZXNwb25zZS5zZXQoJ0NvbnRlbnQtVHlwZScsICdhcHBsaWNhdGlvbi9qc29uJyk7CiAgICAgICAgICByZXR1cm4gcmVzcG9uc2Uuc2VuZChzdGF0c0J5Q2l0eSk7CiAgICAgICAgfSk7Cn07CgpleHBvcnRzLmNyZWF0ZSA9IGNyZWF0ZTsKZXhwb3J0cy5sZWFkc0J5TGVhZFNvdXJjZSA9IGxlYWRzQnlMZWFkU291cmNlOwpleHBvcnRzLmxlYWRzQnlDaXR5ID0gbGVhZHNCeUNpdHk7Cg==</textarea>
<textarea class="saurus-file" data-file="public/js/pieCharts.js" data-mode="javascript">CiQuZ2V0SlNPTignL2xlYWQvc3VtbWFyeS1ieS1sZWFkLXNvdXJjZScsIGZ1bmN0aW9uKHJlc3VsdHMpIHsKICAgIHJlc3VsdHMgPSBfLm1hcChfLnppcChfLmtleXMocmVzdWx0cyksIF8udmFsdWVzKHJlc3VsdHMpKSwKICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKHZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtkZXNjcmlwdGlvbjogdmFsdWVbMF0sIGxlYWRfY291bnQ6IHZhbHVlWzFdfTsKICAgICAgICAgICAgICAgICAgIH0pOwoKICAgIHN1bW1hcnlCeUxlYWRTb3VyY2VEYXRhID0gXy5tYXAocmVzdWx0cywgZnVuY3Rpb24obGVhZFNvdXJjZURhdGFQb2ludCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHZhbHVlOiBsZWFkU291cmNlRGF0YVBvaW50LmxlYWRfY291bnQsCiAgICAgICAgICAgIGNvbG9yOiAnaHNsKCcgKyAoMTgwICogbGVhZFNvdXJjZURhdGFQb2ludC5sZWFkX2NvdW50LyByZXN1bHRzLmxlbmd0aCkgKyAnLCAxMDAlLCA1MCUpJywKICAgICAgICAgICAgbGFiZWw6IGxlYWRTb3VyY2VEYXRhUG9pbnQuZGVzY3JpcHRpb24KICAgICAgICB9OwogICAgfSk7CiAgICB2YXIgYnlMZWFkU291cmNlQ29udGV4dCA9ICQoIiNwaWUtYnktbGVhZC1zb3VyY2UiKS5nZXQoMCkuZ2V0Q29udGV4dCgiMmQiKTsKICAgIHZhciBieUxlYWRTb3VyY2VDaGFydCA9IG5ldyBDaGFydChieUxlYWRTb3VyY2VDb250ZXh0KS5QaWUoc3VtbWFyeUJ5TGVhZFNvdXJjZURhdGEpOwp9KTsKCiQuZ2V0SlNPTignL2xlYWQvc3VtbWFyeS1ieS1jaXR5JywgZnVuY3Rpb24ocmVzdWx0cykgewogICAgcmVzdWx0cyA9IF8ubWFwKF8uemlwKF8ua2V5cyhyZXN1bHRzKSwgXy52YWx1ZXMocmVzdWx0cykpLAogICAgICAgICAgICAgICAgICAgZnVuY3Rpb24odmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge2NpdHk6IHZhbHVlWzBdLCBsZWFkX2NvdW50OiB2YWx1ZVsxXX07CiAgICAgICAgICAgICAgICAgICB9KTsKCiAgICBzdW1tYXJ5QnlDaXR5RGF0YSA9IF8ubWFwKHJlc3VsdHMsIGZ1bmN0aW9uKGNpdHlEYXRhUG9pbnQpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICB2YWx1ZTogY2l0eURhdGFQb2ludC5sZWFkX2NvdW50LAogICAgICAgICAgICBjb2xvcjogJ2hzbCgnICsgKDE4MCAqIGNpdHlEYXRhUG9pbnQubGVhZF9jb3VudC8gcmVzdWx0cy5sZW5ndGgpICsgJywgMTAwJSwgNTAlKScsCiAgICAgICAgICAgIGxhYmVsOiBjaXR5RGF0YVBvaW50LmNpdHkKICAgICAgICB9OwogICAgfSk7CiAgICB2YXIgYnlDaXR5Q29udGV4dCA9ICQoIiNwaWUtYnktY2l0eSIpLmdldCgwKS5nZXRDb250ZXh0KCIyZCIpOwogICAgdmFyIGJ5Q2l0eUNoYXJ0ID0gbmV3IENoYXJ0KGJ5Q2l0eUNvbnRleHQpLlBpZShzdW1tYXJ5QnlDaXR5RGF0YSk7Cn0pOwo=</textarea>
<textarea class="saurus-file" data-file="index.js" data-mode="javascript">dmFyIGh0dHAgPSByZXF1aXJlKCdodHRwJyk7CnZhciBtb25nb29zZSA9IHJlcXVpcmUoJ21vbmdvb3NlJyk7CnZhciBjb25maWcgPSByZXF1aXJlKCcuL2NvbmZpZycpOwoKLy8gSW5pdGlhbGl6ZSBkYXRhYmFzZSBjb25uZWN0aW9uIC0gdGhyb3dzIGlmIGRhdGFiYXNlIGNvbm5lY3Rpb24gY2FuJ3QgYmUKLy8gZXN0YWJsaXNoZWQKbW9uZ29vc2UuY29ubmVjdChjb25maWcubW9uZ29VcmwpOwoKLy8gQ3JlYXRlIEV4cHJlc3Mgd2ViIGFwcAp2YXIgYXBwID0gcmVxdWlyZSgnLi93ZWJhcHAnKTsKCi8vIENyZWF0ZSBhbiBIVFRQIHNlcnZlciBhbmQgbGlzdGVuIG9uIHRoZSBjb25maWd1cmVkIHBvcnQKdmFyIHNlcnZlciA9IGh0dHAuY3JlYXRlU2VydmVyKGFwcCk7CnNlcnZlci5saXN0ZW4oY29uZmlnLnBvcnQsIGZ1bmN0aW9uKCkgewogIGNvbnNvbGUubG9nKCdFeHByZXNzIHNlcnZlciBsaXN0ZW5pbmcgb24gKjonICsgY29uZmlnLnBvcnQpOwp9KTsK</textarea>
</div>
</div><div class="saurus-overview"><ul></ul></div></div><div class="saurus-code"><div class="file-path"><span class="crumb-container"></span><i class="fa fa-fw fa-folder"></i></div><div class="saurus-editor"></div></div><div class="saurus-explorer"><div class="saurus-file-list"></div><a href="https://github.com/TwilioDevEd/call-tracking-laravel" target="_blank" class="explorer-get-code"> <i class="fa fa-lg fa-github-square"> </i>View Code on GitHub</a></div></div></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.2/backbone-min.js"></script><script src="ace/ace.js"></script><script src="ace/theme-monokai.js"></script><script src="viewsaurus.js"></script></body></html>